# Fish completion script for Test TypeScript CLI (testts)
# Auto-generated by goobits-cli

# Main completion function
function __testts_complete
    set -l cmd (commandline -opc)
    set -l current (commandline -ct)
    
    # Try dynamic completion first
    if __testts_dynamic_complete $cmd $current
        return 0
    end
    
    # Fallback to static completion
    __testts_static_complete $cmd $current
end

# Dynamic completion using CLI's built-in completion
function __testts_dynamic_complete
    set -l cmd $argv[1..-2]
    set -l current $argv[-1]
    
    # Check if CLI supports completion
    if not command -v testts >/dev/null 2>&1
        return 1
    end
    
    # Get completion suggestions from the CLI itself
    set -l suggestions (testts _completion fish (commandline -cp) (commandline -C) 2>/dev/null)
    
    if test $status -eq 0; and test -n "$suggestions"
        for suggestion in $suggestions
            echo $suggestion
        end
        return 0
    end
    
    return 1
end

# Static completion as fallback
function __testts_static_complete
    set -l cmd $argv[1..-2]
    set -l current $argv[-1]
    
    # Remove the command name itself
    set -e cmd[1]
    
    # If no subcommand yet, complete with main commands
    if test (count $cmd) -eq 0
        __testts_complete_commands
        return 0
    end
    
    # Handle subcommand completion
    switch $cmd[1]
        case 'hello'
            __testts_complete_hello_options $cmd[2..-1]
        case 'build'
            __testts_complete_build_subcommands $cmd[2..-1]
        case 'serve'
            __testts_complete_serve_options $cmd[2..-1]
        case 'plugin'
            __testts_complete_plugin $cmd[2..-1]
        case 'upgrade'
            __testts_complete_upgrade $cmd[2..-1]
        case 'help'
            __testts_complete_commands
    end
end

# Complete main commands
function __testts_complete_commands
    echo 'hello\tSay hello'
    echo 'build\tBuild something'
    echo 'serve\tStart server'
    echo 'upgrade\tUpgrade Test TypeScript CLI to the latest version'
    echo 'plugin\tðŸ”Œ Manage plugins for Test TypeScript CLI'
    echo 'help\tShow help information'
end

# Complete hello command options
function __testts_complete_hello_options
    echo '--help\tShow help for hello command'
    echo '-h\tShow help for hello command'
end
# Complete build subcommands
function __testts_complete_build_subcommands
    set -l subcmd $argv
    
    if test (count $subcmd) -eq 0
        # List subcommands
        echo 'project\tBuild a project'
    else
        # Complete subcommand options
        switch $subcmd[1]
            case 'project'
                echo '--help\tShow help for project subcommand'
                echo '-h\tShow help for project subcommand'
        end
    end
end
# Complete serve command options
function __testts_complete_serve_options
    echo '--help\tShow help for serve command'
    echo '-h\tShow help for serve command'
end

# Complete plugin command
function __testts_complete_plugin
    set -l subcmd $argv
    
    if test (count $subcmd) -eq 0
        echo 'list\tList all available and loaded plugins'
        echo 'ls\tList all available and loaded plugins'
        echo 'install\tInstall a plugin from npm'
        echo 'uninstall\tUninstall a plugin'
        echo 'remove\tUninstall a plugin'
        echo 'create\tCreate a new plugin template'
        echo 'info\tShow detailed information about a plugin'
    else
        switch $subcmd[1]
            case 'list' 'ls'
                echo '--json\tOutput as JSON'
                echo '--help\tShow help for plugin list'
                echo '-h\tShow help for plugin list'
            case 'install'
                echo '--global\tInstall globally'
                echo '-g\tInstall globally'
                echo '--version\tInstall specific version'
                echo '--help\tShow help for plugin install'
                echo '-h\tShow help for plugin install'
            case 'uninstall' 'remove'
                echo '--global\tUninstall globally'
                echo '-g\tUninstall globally'
                echo '--help\tShow help for plugin uninstall'
                echo '-h\tShow help for plugin uninstall'
            case 'create'
                echo '--type\tPlugin type (function|class|npm)'
                echo '--dir\tOutput directory'
                echo '--help\tShow help for plugin create'
                echo '-h\tShow help for plugin create'
            case 'info'
                echo '--help\tShow help for plugin info'
                echo '-h\tShow help for plugin info'
        end
    end
end

# Complete upgrade command
function __testts_complete_upgrade
    echo '--check\tCheck for updates without installing'
    echo '--version\tInstall specific version'
    echo '--pre\tInclude pre-release versions'
    echo '--dry-run\tShow what would be done without doing it'
    echo '--help\tShow help for upgrade command'
    echo '-h\tShow help for upgrade command'
end

# Helper function to check if we're completing an option value
function __testts_completing_option
    set -l cmd (commandline -opc)
    if test (count $cmd) -gt 1
        switch $cmd[-1]
            case '--version' '--type' '--dir'
                return 0
        end
    end
    return 1
end

# Register completions
complete -c testts -f -a '(__testts_complete)'

# Global options
complete -c testts -l help -s h -d 'Show help information'
complete -c testts -l version -s V -d 'Show version information'

# Command-specific completions with conditions

# Plugin command specific options
complete -c testts -n '__fish_seen_subcommand_from plugin; and __fish_seen_subcommand_from list' -l json -d 'Output as JSON'
complete -c testts -n '__fish_seen_subcommand_from plugin; and __fish_seen_subcommand_from install' -l global -s g -d 'Install globally'
complete -c testts -n '__fish_seen_subcommand_from plugin; and __fish_seen_subcommand_from install' -l version -d 'Install specific version'
complete -c testts -n '__fish_seen_subcommand_from plugin; and __fish_seen_subcommand_from uninstall' -l global -s g -d 'Uninstall globally'
complete -c testts -n '__fish_seen_subcommand_from plugin; and __fish_seen_subcommand_from create' -l type -d 'Plugin type' -a 'function class npm'
complete -c testts -n '__fish_seen_subcommand_from plugin; and __fish_seen_subcommand_from create' -l dir -d 'Output directory' -a '(__fish_complete_directories)'

# Upgrade command options
complete -c testts -n '__fish_seen_subcommand_from upgrade' -l check -d 'Check for updates without installing'
complete -c testts -n '__fish_seen_subcommand_from upgrade' -l version -d 'Install specific version'
complete -c testts -n '__fish_seen_subcommand_from upgrade' -l pre -d 'Include pre-release versions'
complete -c testts -n '__fish_seen_subcommand_from upgrade' -l dry-run -d 'Show what would be done without doing it'

# File completion for certain options
complete -c testts -n '__fish_prev_arg_in --config --file -f' -a '(__fish_complete_path)'
complete -c testts -n '__fish_prev_arg_in --dir --directory -d' -a '(__fish_complete_directories)'

# Support for npx execution
complete -c npx -n '__fish_prev_arg_in npx && __fish_seen_subcommand_from testts' -f -a '(__testts_complete)'