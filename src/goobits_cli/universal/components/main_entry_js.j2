{#
Universal Component: Main entry JavaScript file for TypeScript projects
This creates a simple JS wrapper when TypeScript compilation is not available.
#}
#!/usr/bin/env node
/**
 * JavaScript entry point for {{ project.name }}
 * Generated by Goobits CLI Framework - Simple wrapper for testing
 */

import { Command } from 'commander';

const program = new Command();

program
  .name('{{ project.command_name }}')
  .description('{{ project.description }}')
  .version('{{ project.version }}');

{% if cli and cli.global_options %}
// Global options
{% for option in cli.global_options %}
program.option('{{ option.flag if option.flag else "--" + option.name }}', '{{ option.description | default("") }}');
{% endfor %}
{% endif %}

{% if cli and cli.root_command and cli.root_command.subcommands %}
// Commands
{% for command in cli.root_command.subcommands %}
program
  .command('{{ command.name }}')
  .description('{{ command.description | default("") }}')
  {% for argument in command.arguments | default([]) %}
  .argument('{{ argument.name | default("value") }}', '{{ argument.description | default("") }}')
  {% endfor %}
  {% for option in command.options | default([]) %}
  .option('{{ option.flag if option.flag else "--" + option.name }}', '{{ option.description | default("") }}')
  {% endfor %}
  .action(async ({% for argument in command.arguments | default([]) %}{{ argument.name | default("value") }}{{ ", " if not loop.last }}{% endfor %}{% if command.arguments %}, {% endif %}options) => {
    // Simple test response for integration tests
    if (process.argv.includes('--help')) {
      console.log('Usage: {{ project.command_name }} {{ command.name }} [options]');
      {% for argument in command.arguments | default([]) %}
      console.log('  {{ argument.name }}: {{ argument.description | default("argument") }}');
      {% endfor %}
      {% for option in command.options | default([]) %}
      console.log('  {{ option.flag if option.flag else "--" + option.name }}: {{ option.description | default("option") }}');
      {% endfor %}
      return;
    }
    console.log('{{ project.command_name }} {{ command.name }} - Integration test mode');
    console.log('Command executed successfully!');
  });
{% endfor %}
{% endif %}

// Handle --help and --version at root level
if (process.argv.includes('--help') || process.argv.length === 2) {
  program.outputHelp();
  process.exit(0);
}

if (process.argv.includes('--version')) {
  console.log('{{ project.version }}');
  process.exit(0);
}

// Parse and execute
try {
  await program.parseAsync(process.argv);
} catch (error) {
  console.error('Error:', error.message);
  process.exit(1);
}