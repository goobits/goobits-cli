{#
Universal Component: Binary entry script template for Node.js/TypeScript CLIs

This template generates the executable binary entry point file that goes 
in the bin/ directory and is referenced by package.json's "bin" field.

Template Variables Expected:
  - project: Project configuration  
  - cli: CLI configuration
  - nodejs: Node.js specific context
#}
#!/usr/bin/env node

/**
 * Binary entry point for {{ project.command_name }}
 * Generated by Goobits CLI Framework using Universal Templates
 */

// Import and run the CLI from the main entry point
{% if typescript is defined and typescript.main_entry %}
// Try compiled JS first, fall back to TypeScript with ts-node for dev/test environments
try {
  const { cli } = await import('../{{ typescript.main_entry.replace('.ts', '.js') }}');
  cli();
} catch (err) {
  if (err.code === 'ERR_MODULE_NOT_FOUND') {
    // Compiled JS not found, try TypeScript with ts-node
    try {
      const tsNode = await import('ts-node');
      tsNode.register({ esm: true });
      const { cli } = await import('../{{ typescript.main_entry }}');
      cli();
    } catch (tsErr) {
      console.error('Failed to run CLI: compiled JS not found and TypeScript execution failed');
      console.error('Run "npm run build" to compile TypeScript, or install ts-node for development');
      process.exit(1);
    }
  } else {
    throw err;
  }
}
{% elif nodejs is defined and nodejs.main_entry %}
import { cli } from '../{{ nodejs.main_entry }}';
cli();
{% else %}
import { cli } from '../index.js';
cli();
{% endif %}