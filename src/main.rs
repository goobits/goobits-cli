//! Generated by goobits-cli
//! 
//! Note: Rust templates are not yet installed.
//! This is a basic CLI structure. To get full functionality,
//! ensure Rust templates are installed in:
//! src/goobits_cli/templates/rust/

use clap::{Arg, ArgMatches, Command};
use std::process;

mod hooks;

fn main() {
    let app = Command::new("test_rust")
        .about("A CLI tool")
        .version("2.0.0-beta.1")
        .subcommand_required(false)
        .arg_required_else_help(true);
    
    let app = build_cli(app);
    let matches = app.get_matches();
    
    if let Err(e) = handle_command(&matches) {
        eprintln!("Error: {}", e);
        process::exit(1);
    }
}

fn build_cli(app: Command) -> Command {
    let mut app = app;
    
    // Add commands from configuration
    app = app.subcommand(
        Command::new("hello")
            .about("Say hello")
            .arg(Arg::new("name")
                .help("Name to greet")
                .required(false)
                .index(1))
            .arg(Arg::new("greeting")
                .help("Custom greeting")
                .short('g')
                .long("greeting").value_name("VALUE"))
    );
    
    app
}

fn handle_command(matches: &ArgMatches) -> Result<(), Box<dyn std::error::Error>> {
    match matches.subcommand() {
        Some(("hello", sub_matches)) => {
            println!("Executing hello command...");
            hooks::on_hello(sub_matches)?;
            Ok(())
        }
        _ => {
            println!("No command specified. Use --help for available commands.");
            Ok(())
        }
    }
}
