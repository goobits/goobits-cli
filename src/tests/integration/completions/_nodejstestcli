#compdef nodejstestcli
# Zsh completion script for NodeJSTestCLI (nodejstestcli)
# Auto-generated by goobits-cli

# Main completion function
_nodejstestcli() {
    local context state state_descr line
    typeset -A opt_args

    # Try dynamic completion first
    if _nodejstestcli_dynamic; then
        return 0
    fi

    # Fallback to static completion
    _nodejstestcli_static
}

# Dynamic completion using CLI's built-in completion
_nodejstestcli_dynamic() {
    local cli_bin="nodejstestcli"
    
    # Check if CLI supports completion
    if ! command -v "$cli_bin" >/dev/null 2>&1; then
        return 1
    fi
    
    # Get completion suggestions from the CLI itself
    local suggestions
    suggestions=(${(f)"$("$cli_bin" _completion zsh "$words" "$#BUFFER" 2>/dev/null)"})
    
    if [[ $#suggestions -gt 0 ]]; then
        compadd -a suggestions
        return 0
    fi
    
    return 1
}

# Static completion as fallback
_nodejstestcli_static() {
    local context state state_descr line
    typeset -A opt_args

    _arguments -C \
        '(-v --verbose)'{-v,--verbose}'[Enable verbose logging]' \
        '(-c --config)'{-c,--config}'[Path to configuration file]:str:_nodejstestcli_config' \
        '(-h --help)'{-h,--help}'[Show help information]' \
        '(-V --version)'{-V,--version}'[Show version information]' \
        '1: :_nodejstestcli_commands' \
        '*::arg:->args' && return 0

    case $state in
        args)
            case $words[1] in
                init)
                    _nodejstestcli_init
                    ;;
                deploy)
                    _nodejstestcli_deploy
                    ;;
                server)
                    _nodejstestcli_server_subcommands
                    ;;
                database)
                    _nodejstestcli_database_subcommands
                    ;;
                test)
                    _nodejstestcli_test
                    ;;
                plugin)
                    _nodejstestcli_plugin
                    ;;
                upgrade)
                    _nodejstestcli_upgrade
                    ;;
            esac
            ;;
    esac
}

# Command completion
_nodejstestcli_commands() {
    local commands=(
        'init:Initialize a new project'
        'deploy:Deploy the application'
        'server:Server management commands'
        'database:Database operations'
        'test:Run tests'
        'upgrade:Upgrade NodeJSTestCLI to the latest version'
        'plugin:ðŸ”Œ Manage plugins for NodeJSTestCLI'
        'help:Show help information'
    )
    _describe 'commands' commands
}

# init command completion
_nodejstestcli_init() {
    _arguments \
        '(-t --template)'{-t,--template}'[Project template to use]:str:' \
        '--skip-install[Skip npm install]' \
        '(-h --help)'{-h,--help}'[Show help for init command]' \
        ':name:Project name' \
}
# deploy command completion
_nodejstestcli_deploy() {
    _arguments \
        '(-f --force)'{-f,--force}'[Force deployment without confirmation]' \
        '--dry-run[Simulate deployment without making changes]' \
        '(-h --help)'{-h,--help}'[Show help for deploy command]' \
        ':environment:Target environment (dev, staging, prod)' \
}
# server subcommands completion
_nodejstestcli_server_subcommands() {
    local subcommands=(
        'start:Start the server'
        'stop:Stop the server'
        'restart:Restart the server'
    )
    
    if [[ $CURRENT -eq 2 ]]; then
        _describe 'server subcommands' subcommands
    else
        case $words[2] in
            start)
                _arguments \
                    '(-p --port)'{-p,--port}'[Port to listen on]:int:' \
                    '(-d --daemon)'{-d,--daemon}'[Run as daemon]' \
                    '(-h --help)'{-h,--help}'[Show help for start subcommand]' \
                ;;
            stop)
                _arguments \
                    '--graceful[Graceful shutdown]' \
                    '(-h --help)'{-h,--help}'[Show help for stop subcommand]' \
                ;;
            restart)
                _arguments \
                    '(-h --help)'{-h,--help}'[Show help for restart subcommand]' \
                    '::service:Service name to restart' \
                ;;
        esac
    fi
}
# database subcommands completion
_nodejstestcli_database_subcommands() {
    local subcommands=(
        'migrate:Run database migrations'
        'seed:Seed the database'
        'backup:Backup the database'
    )
    
    if [[ $CURRENT -eq 2 ]]; then
        _describe 'database subcommands' subcommands
    else
        case $words[2] in
            migrate)
                _arguments \
                    '--direction[Migration direction (up/down)]:str:' \
                    '--steps[Number of migrations to run]:int:' \
                    '(-h --help)'{-h,--help}'[Show help for migrate subcommand]' \
                ;;
            seed)
                _arguments \
                    '--truncate[Truncate tables before seeding]' \
                    '(-h --help)'{-h,--help}'[Show help for seed subcommand]' \
                    '::dataset:Dataset to seed' \
                ;;
            backup)
                _arguments \
                    '(-o --output)'{-o,--output}'[Output file path]:str:' \
                    '--compress[Compress the backup]' \
                    '(-h --help)'{-h,--help}'[Show help for backup subcommand]' \
                ;;
        esac
    fi
}
# test command completion
_nodejstestcli_test() {
    _arguments \
        '--coverage[Generate coverage report]' \
        '(-w --watch)'{-w,--watch}'[Watch files for changes]' \
        '--bail[Stop on first test failure]' \
        '(-h --help)'{-h,--help}'[Show help for test command]' \
        '::pattern:Test file pattern' \
}

# Plugin command completion
_nodejstestcli_plugin() {
    local plugin_commands=(
        'list:List all available and loaded plugins'
        'install:Install a plugin from npm'
        'uninstall:Uninstall a plugin'
        'create:Create a new plugin template'
        'info:Show detailed information about a plugin'
    )
    
    if [[ $CURRENT -eq 2 ]]; then
        _describe 'plugin commands' plugin_commands
    else
        case $words[2] in
            list)
                _arguments \
                    '--json[Output as JSON]' \
                    '(-h --help)'{-h,--help}'[Show help for plugin list]'
                ;;
            install)
                _arguments \
                    '(-g --global)'{-g,--global}'[Install globally]' \
                    '--version[Install specific version]:version:' \
                    '(-h --help)'{-h,--help}'[Show help for plugin install]' \
                    ':plugin-name:'
                ;;
            uninstall|remove)
                _arguments \
                    '(-g --global)'{-g,--global}'[Uninstall globally]' \
                    '(-h --help)'{-h,--help}'[Show help for plugin uninstall]' \
                    ':plugin-name:'
                ;;
            create)
                _arguments \
                    '--type[Plugin type]:type:(function class npm)' \
                    '--dir[Output directory]:directory:_directories' \
                    '(-h --help)'{-h,--help}'[Show help for plugin create]' \
                    ':plugin-name:'
                ;;
            info)
                _arguments \
                    '(-h --help)'{-h,--help}'[Show help for plugin info]' \
                    ':plugin-name:'
                ;;
        esac
    fi
}

# Upgrade command completion
_nodejstestcli_upgrade() {
    _arguments \
        '--check[Check for updates without installing]' \
        '--version[Install specific version]:version:' \
        '--pre[Include pre-release versions]' \
        '--dry-run[Show what would be done without doing it]' \
        '(-h --help)'{-h,--help}'[Show help for upgrade command]'
}

# Custom completion functions for specific option types
_nodejstestcli_config() {
    # Custom completion for config option
    # Add your custom completion logic here
    _default
}

# Load the completion
_nodejstestcli "$@"

# Enable completion caching for better performance
zstyle ':completion:*:*:nodejstestcli:*' cache-policy _nodejstestcli_cache_policy
_nodejstestcli_cache_policy() {
    # Cache completions for 1 hour
    [[ -n "$1" && "$1" -ot "$(date -v-1H)" ]]
}

# Add color support
zstyle ':completion:*:*:nodejstestcli:*:descriptions' format '%F{green}-- %d --%f'
zstyle ':completion:*:*:nodejstestcli:*:commands' group-name commands
zstyle ':completion:*:*:nodejstestcli:*:options' group-name options