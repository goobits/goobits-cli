#!/usr/bin/env python3
"""
Test Application - A simple test CLI
Generated by Goobits CLI Framework
"""

import click
import sys
from typing import Any
try:
    from .hooks import *  # Import all hook functions
except ImportError:
    # Hooks not implemented yet
    pass
@click.group(
    name="testapp",
    help="A simple CLI for testing",
    context_settings={"help_option_names": ["-h", "--help"]}
)
@click.version_option(version="None")

def cli():
    """A simple CLI for testing"""
    pass
@cli.command(name="hello", help="Say hello to someone")
@click.argument("name")
@click.option(
    "--loud", "-l",
    help="Use loud greeting",
    is_flag=True,)
def hello_command(name, loud):
    """Say hello to someone"""
    try:
        # Initialize error handler with verbose flag from global options
        from .errors import ErrorHandler, set_error_handler
        ctx = click.get_current_context()
        verbose_flag = ctx.find_root().params.get('verbose', False)
        error_handler = ErrorHandler(verbose=verbose_flag)
        set_error_handler(error_handler)

        # Call the hook function if it exists
        hook_name = "on_hello"
        if hook_name in globals():
            hook_func = globals()[hook_name]
            hook_func(name, loud)
        else:
            click.echo(f"Hook function '{hook_name}' not implemented")
            sys.exit(1)
    except Exception as e:
        # Use error handler for proper verbose output
        try:
            from .errors import get_error_handler
            error_handler = get_error_handler()
            error_handler.handle_error(e, "Command execution")
        except ImportError:
            click.echo(f"Error: {e}", err=True)
            # Try to get verbose flag again for fallback
            try:
                ctx = click.get_current_context()
                verbose_fallback = ctx.find_root().params.get('verbose', False)
                if verbose_fallback:
                    import traceback
                    traceback.print_exc()
            except:
                pass
            sys.exit(1)
if __name__ == "__main__":
    cli()